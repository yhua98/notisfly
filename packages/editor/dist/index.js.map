{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html } from 'lit';\r\nimport { repeat } from 'lit/directives/repeat.js';\r\nimport { customElement, property, query } from 'lit/decorators.js';\r\nimport { PageEditor } from '@blocksuite/presets';\r\nimport { effects as presetsEffects } from '@blocksuite/presets/effects';\r\nimport { effects as blocksEffects } from '@blocksuite/blocks/effects';\r\nimport type { Doc } from '@blocksuite/store';\r\nimport { SignalWatcher, WithDisposable } from '@blocksuite/global/utils';\r\nimport { ShadowlessElement } from '@blocksuite/block-std';\r\n// import { RichText } from '@blocksuite/blocks'\r\nimport * as Y from 'yjs';\r\nimport { enter } from './event.js'\r\n\r\npresetsEffects();\r\nblocksEffects();\r\n\r\n@customElement('not-editor')\r\nexport class NotEditor extends SignalWatcher(WithDisposable(ShadowlessElement)) {\r\n\tstatic override styles = css`\r\n\t.editor-container{\r\n\t\tbox-sizing: border-box;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tcontainer-name: editor-container;\r\n\t\tcontainer-type: inline-size;\r\n\t}\r\n\r\n\t.editor-container-header {\r\n\t\tpadding-right: var(--affine-editor-side-padding, 24px);\r\n\t\tpadding-left: var(--affine-editor-side-padding, 24px);\r\n\t\tmargin: 0 auto;\r\n\t\tmax-width: var(--affine-editor-width);\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t@container editor-container (width <= 640px) {\r\n\t\t.editor-container-header {\r\n\t\t\tpadding-right: 24px;\r\n\t\t\tpadding-left: 24px;\r\n\t\t}\r\n\t}\r\n\r\n\t.editor-container-page-editor{\r\n\t\tflex-grow: 1;\r\n\t}\r\n\r\n\t.editor-container-page-editor .h1 {\r\n\t\tfont-size: 26px;\r\n\t\tfont-weight: 600;\r\n\t\theight: auto !important;\r\n\t}\r\n\r\n\t.tags {\r\n\t\tmargin-bottom: 8px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.tag {\r\n\t\tmargin-left: 4px;\r\n\t\tbackground-color: var(--custom-tag-bg);\r\n\t\tpadding: 4px 8px;\r\n\t\tcolor: var(--custom-tag-color);\r\n\t}\r\n\t.tag:first-child{\r\n\t\tmargin-left: 0;\r\n\t}\r\n\t.tag:first-child {\r\n\t\tmargin-left: 0;\r\n\t}\r\n\t.tags > input {\r\n\t\toutline: none;\r\n\t\tbackground: transparent;\r\n\t\twidth: 4em;\r\n\t\tpadding: 2px 8px;\r\n\t\tborder: 2px solid var(--custom-tag-border);\r\n\t\tborder-radius: 8px;\r\n\t\tmargin-left: 8px;\r\n\t}\r\n\r\n\t.tags > input:focus {\r\n\t\tborder-color: var(--custom-tag-focus-border);\r\n\t}\r\n\r\n\t.tags > input:first-child {\r\n\t\tmargin-left: 0;\r\n\t}\r\n\t.title {\r\n\t\tmargin-bottom: 8px;\r\n\t}\r\n\t.title > input {\r\n\t\tbackground: transparent;\r\n\t\toutline: none;\r\n\t\tfont-size: 24px;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\t`\r\n\r\n\t@property({ type: String })\r\n\taccessor name = 'world';\r\n\r\n\t@property({ attribute: false })\r\n\taccessor pageEditor: PageEditor;\r\n\r\n\t@property({ attribute: false })\r\n\taccessor tags: string[] = [];\r\n\r\n\t@property({ attribute: false })\r\n\taccessor doc!: Doc;\r\n\r\n\r\n\r\n\t@property({ type: String })\r\n\toverride accessor title = '';\r\n\r\n\t@property({ type: Boolean })\r\n\taccessor isReadonly = false;\r\n\r\n\t@property({ attribute: false })\r\n\taccessor yText!: Y.Text;\r\n\r\n\t@property({ attribute: false })\r\n\taccessor readonly = false;\r\n\r\n\tsetTitle(event: InputEvent) {\r\n\t\tthis.title = (event.target as HTMLInputElement).value;\r\n\t\tthis.yText?.delete(0, this.yText.length);\r\n\t\tthis.yText?.insert(0, this.title);\r\n\t\tthis.doc.collection.setDocMeta(this.doc.id, { title: this.title });\r\n\t}\r\n\r\n\t@query('#title-input', false)\r\n\taccessor titleInput!: HTMLInputElement;\r\n\r\n\tsetDoc(doc: Doc) {\r\n\t\tthis.doc = doc;\r\n\t\tif (!doc) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\t// @ts-ignore\r\n\t\tthis.yText = doc.root.title.yText;\r\n\r\n\t\t{\r\n\t\t\t// init tags\r\n\t\t\tconst tags = doc.spaceDoc.getArray<string>('tags');\r\n\t\t\tconsole.log('tags', this.doc.meta!.tags);\r\n\t\t\ttags.insert(0, [...(this.doc.meta!.tags || [])]);\r\n\t\t}\r\n\r\n\t\tthis.tags = doc.spaceDoc.getArray<string>('tags').toArray();\r\n\t\tthis.readonly = doc.readonly;\r\n\t\tthis.pageEditor.doc = doc;\r\n\r\n\t\tif (this.titleInput) {\r\n\t\t\tthis.titleInput.value = this.yText.toString();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addTag(event: KeyboardEvent) {\r\n\t\tconst target = event.target as HTMLInputElement;\r\n\t\tconst value = target.value;\r\n\t\tconst tags = this.doc?.spaceDoc.getArray<string>('tags');\r\n\t\ttags?.push([value]);\r\n\t\tthis.tags = [...this.tags, value];\r\n\t\ttarget.value = '';\r\n\t\t// this.requestUpdate();\r\n\t}\r\n\r\n\toverride connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (this.doc && this.titleInput && this.yText) {\r\n\t\t\t\tthis.titleInput.value = this.yText.toString();\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`<div class=\"editor-container\">\r\n\t\t\t<div class=\"editor-container-header\">\r\n\t\t\t\t<div class=\"title\">\r\n\t\t\t\t\t<input .disabled=\"${this.readonly}\" autocomplete=\"off\" id=\"title-input\" @input=\"${this.setTitle}\" placeholder=\"标题\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"tags\">\r\n\t\t\t\t\t${repeat(this.tags, (tag) => tag, (tag) => html`<span class=\"tag\">#${tag}</span>`)}\r\n\t\t\t\t\t<input .disabled=\"${this.readonly}\" @keyup=\"${enter.call(this, this.addTag)}\" placeholder=\"+ tag\" />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"editor-container-page-editor\">\r\n\t\t\t\t${this.doc && this.pageEditor}\r\n\t\t\t</div>\r\n        </div>`;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.pageEditor = new PageEditor();\r\n\t}\r\n}\r\n"]}